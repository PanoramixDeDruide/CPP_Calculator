??=define JOIN(a, b) a??=??=b
??=define XJOIN(a, b) JOIN(a, b)

??=define ADD0_0 0
??=define ADD0_1 1
??=define ADD0_2 2
??=define ADD0_3 3
??=define ADD0_4 4
??=define ADD0_5 5
??=define ADD0_6 6
??=define ADD0_7 7
??=define ADD0_8 8
??=define ADD0_9 9

??=define ADD1_0 1
??=define ADD1_1 2
??=define ADD1_2 3
??=define ADD1_3 4
??=define ADD1_4 5
??=define ADD1_5 6
??=define ADD1_6 7
??=define ADD1_7 8
??=define ADD1_8 9
??=define ADD1_9 0

??=define ADD2_0 2
??=define ADD2_1 3
??=define ADD2_2 4
??=define ADD2_3 5
??=define ADD2_4 6
??=define ADD2_5 7
??=define ADD2_6 8
??=define ADD2_7 9
??=define ADD2_8 0
??=define ADD2_9 1

??=define ADD3_0 3
??=define ADD3_1 4
??=define ADD3_2 5
??=define ADD3_3 6
??=define ADD3_4 7
??=define ADD3_5 8
??=define ADD3_6 9
??=define ADD3_7 0
??=define ADD3_8 1
??=define ADD3_9 2

??=define ADD4_0 4
??=define ADD4_1 5
??=define ADD4_2 6
??=define ADD4_3 7
??=define ADD4_4 8
??=define ADD4_5 9
??=define ADD4_6 0
??=define ADD4_7 1
??=define ADD4_8 2
??=define ADD4_9 3

??=define ADD5_0 5
??=define ADD5_1 6
??=define ADD5_2 7
??=define ADD5_3 8
??=define ADD5_4 9
??=define ADD5_5 0
??=define ADD5_6 1
??=define ADD5_7 2
??=define ADD5_8 3
??=define ADD5_9 4

??=define ADD6_0 6
??=define ADD6_1 7
??=define ADD6_2 8
??=define ADD6_3 9
??=define ADD6_4 0
??=define ADD6_5 1
??=define ADD6_6 2
??=define ADD6_7 3
??=define ADD6_8 4
??=define ADD6_9 5

??=define ADD7_0 7
??=define ADD7_1 8
??=define ADD7_2 9
??=define ADD7_3 0
??=define ADD7_4 1
??=define ADD7_5 2
??=define ADD7_6 3
??=define ADD7_7 4
??=define ADD7_8 5
??=define ADD7_9 6

??=define ADD8_0 8
??=define ADD8_1 9
??=define ADD8_2 0
??=define ADD8_3 1
??=define ADD8_4 2
??=define ADD8_5 3
??=define ADD8_6 4
??=define ADD8_7 5
??=define ADD8_8 6
??=define ADD8_9 7

??=define ADD9_0 9
??=define ADD9_1 0
??=define ADD9_2 1
??=define ADD9_3 2
??=define ADD9_4 3
??=define ADD9_5 4
??=define ADD9_6 5
??=define ADD9_7 6
??=define ADD9_8 7
??=define ADD9_9 8

??=define CARRY2_0_0 0
??=define CARRY2_0_1 0
??=define CARRY2_0_2 0
??=define CARRY2_0_3 0
??=define CARRY2_0_4 0
??=define CARRY2_0_5 0
??=define CARRY2_0_6 0
??=define CARRY2_0_7 0
??=define CARRY2_0_8 0
??=define CARRY2_0_9 0

??=define CARRY2_1_0 0
??=define CARRY2_1_1 0
??=define CARRY2_1_2 0
??=define CARRY2_1_3 0
??=define CARRY2_1_4 0
??=define CARRY2_1_5 0
??=define CARRY2_1_6 0
??=define CARRY2_1_7 0
??=define CARRY2_1_8 0
??=define CARRY2_1_9 1

??=define CARRY2_2_0 0
??=define CARRY2_2_1 0
??=define CARRY2_2_2 0
??=define CARRY2_2_3 0
??=define CARRY2_2_4 0
??=define CARRY2_2_5 0
??=define CARRY2_2_6 0
??=define CARRY2_2_7 0
??=define CARRY2_2_8 1
??=define CARRY2_2_9 1

??=define CARRY2_3_0 0
??=define CARRY2_3_1 0
??=define CARRY2_3_2 0
??=define CARRY2_3_3 0
??=define CARRY2_3_4 0
??=define CARRY2_3_5 0
??=define CARRY2_3_6 0
??=define CARRY2_3_7 1
??=define CARRY2_3_8 1
??=define CARRY2_3_9 1

??=define CARRY2_4_0 0
??=define CARRY2_4_1 0
??=define CARRY2_4_2 0
??=define CARRY2_4_3 0
??=define CARRY2_4_4 0
??=define CARRY2_4_5 0
??=define CARRY2_4_6 1
??=define CARRY2_4_7 1
??=define CARRY2_4_8 1
??=define CARRY2_4_9 1

??=define CARRY2_5_0 0
??=define CARRY2_5_1 0
??=define CARRY2_5_2 0
??=define CARRY2_5_3 0
??=define CARRY2_5_4 0
??=define CARRY2_5_5 1
??=define CARRY2_5_6 1
??=define CARRY2_5_7 1
??=define CARRY2_5_8 1
??=define CARRY2_5_9 1

??=define CARRY2_6_0 0
??=define CARRY2_6_1 0
??=define CARRY2_6_2 0
??=define CARRY2_6_3 0
??=define CARRY2_6_4 1
??=define CARRY2_6_5 1
??=define CARRY2_6_6 1
??=define CARRY2_6_7 1
??=define CARRY2_6_8 1
??=define CARRY2_6_9 1

??=define CARRY2_7_0 0
??=define CARRY2_7_1 0
??=define CARRY2_7_2 0
??=define CARRY2_7_3 1
??=define CARRY2_7_4 1
??=define CARRY2_7_5 1
??=define CARRY2_7_6 1
??=define CARRY2_7_7 1
??=define CARRY2_7_8 1
??=define CARRY2_7_9 1

??=define CARRY2_8_0 0
??=define CARRY2_8_1 0
??=define CARRY2_8_2 1
??=define CARRY2_8_3 1
??=define CARRY2_8_4 1
??=define CARRY2_8_5 1
??=define CARRY2_8_6 1
??=define CARRY2_8_7 1
??=define CARRY2_8_8 1
??=define CARRY2_8_9 1

??=define CARRY2_9_0 0
??=define CARRY2_9_1 1
??=define CARRY2_9_2 1
??=define CARRY2_9_3 1
??=define CARRY2_9_4 1
??=define CARRY2_9_5 1
??=define CARRY2_9_6 1
??=define CARRY2_9_7 1
??=define CARRY2_9_8 1
??=define CARRY2_9_9 1

??=define HADD3_0_0_0 0
??=define HADD3_0_1_0 1
??=define HADD3_0_2_0 2
??=define HADD3_0_3_0 3
??=define HADD3_0_4_0 4
??=define HADD3_0_5_0 5
??=define HADD3_0_6_0 6
??=define HADD3_0_7_0 7
??=define HADD3_0_8_0 8
??=define HADD3_0_9_0 9

??=define HADD3_1_0_0 1
??=define HADD3_1_1_0 2
??=define HADD3_1_2_0 3
??=define HADD3_1_3_0 4
??=define HADD3_1_4_0 5
??=define HADD3_1_5_0 6
??=define HADD3_1_6_0 7
??=define HADD3_1_7_0 8
??=define HADD3_1_8_0 9
??=define HADD3_1_9_0 0

??=define HADD3_2_0_0 2
??=define HADD3_2_1_0 3
??=define HADD3_2_2_0 4
??=define HADD3_2_3_0 5
??=define HADD3_2_4_0 6
??=define HADD3_2_5_0 7
??=define HADD3_2_6_0 8
??=define HADD3_2_7_0 9
??=define HADD3_2_8_0 0
??=define HADD3_2_9_0 1

??=define HADD3_3_0_0 3
??=define HADD3_3_1_0 4
??=define HADD3_3_2_0 5
??=define HADD3_3_3_0 6
??=define HADD3_3_4_0 7
??=define HADD3_3_5_0 8
??=define HADD3_3_6_0 9
??=define HADD3_3_7_0 0
??=define HADD3_3_8_0 1
??=define HADD3_3_9_0 2

??=define HADD3_4_0_0 4
??=define HADD3_4_1_0 5
??=define HADD3_4_2_0 6
??=define HADD3_4_3_0 7
??=define HADD3_4_4_0 8
??=define HADD3_4_5_0 9
??=define HADD3_4_6_0 0
??=define HADD3_4_7_0 1
??=define HADD3_4_8_0 2
??=define HADD3_4_9_0 3

??=define HADD3_5_0_0 5
??=define HADD3_5_1_0 6
??=define HADD3_5_2_0 7
??=define HADD3_5_3_0 8
??=define HADD3_5_4_0 9
??=define HADD3_5_5_0 0
??=define HADD3_5_6_0 1
??=define HADD3_5_7_0 2
??=define HADD3_5_8_0 3
??=define HADD3_5_9_0 4

??=define HADD3_6_0_0 6
??=define HADD3_6_1_0 7
??=define HADD3_6_2_0 8
??=define HADD3_6_3_0 9
??=define HADD3_6_4_0 0
??=define HADD3_6_5_0 1
??=define HADD3_6_6_0 2
??=define HADD3_6_7_0 3
??=define HADD3_6_8_0 4
??=define HADD3_6_9_0 5

??=define HADD3_7_0_0 7
??=define HADD3_7_1_0 8
??=define HADD3_7_2_0 9
??=define HADD3_7_3_0 0
??=define HADD3_7_4_0 1
??=define HADD3_7_5_0 2
??=define HADD3_7_6_0 3
??=define HADD3_7_7_0 4
??=define HADD3_7_8_0 5
??=define HADD3_7_9_0 6

??=define HADD3_8_0_0 8
??=define HADD3_8_1_0 9
??=define HADD3_8_2_0 0
??=define HADD3_8_3_0 1
??=define HADD3_8_4_0 2
??=define HADD3_8_5_0 3
??=define HADD3_8_6_0 4
??=define HADD3_8_7_0 5
??=define HADD3_8_8_0 6
??=define HADD3_8_9_0 7

??=define HADD3_9_0_0 9
??=define HADD3_9_1_0 0
??=define HADD3_9_2_0 1
??=define HADD3_9_3_0 2
??=define HADD3_9_4_0 3
??=define HADD3_9_5_0 4
??=define HADD3_9_6_0 5
??=define HADD3_9_7_0 6
??=define HADD3_9_8_0 7
??=define HADD3_9_9_0 8

??=define HADD3_0_0_1 1
??=define HADD3_0_1_1 2
??=define HADD3_0_2_1 3
??=define HADD3_0_3_1 4
??=define HADD3_0_4_1 5
??=define HADD3_0_5_1 6
??=define HADD3_0_6_1 7
??=define HADD3_0_7_1 8
??=define HADD3_0_8_1 9
??=define HADD3_0_9_1 0

??=define HADD3_1_0_1 2
??=define HADD3_1_1_1 3
??=define HADD3_1_2_1 4
??=define HADD3_1_3_1 5
??=define HADD3_1_4_1 6
??=define HADD3_1_5_1 7
??=define HADD3_1_6_1 8
??=define HADD3_1_7_1 9
??=define HADD3_1_8_1 0
??=define HADD3_1_9_1 1

??=define HADD3_2_0_1 3
??=define HADD3_2_1_1 4
??=define HADD3_2_2_1 5
??=define HADD3_2_3_1 6
??=define HADD3_2_4_1 7
??=define HADD3_2_5_1 8
??=define HADD3_2_6_1 9
??=define HADD3_2_7_1 0
??=define HADD3_2_8_1 1
??=define HADD3_2_9_1 2

??=define HADD3_3_0_1 4
??=define HADD3_3_1_1 5
??=define HADD3_3_2_1 6
??=define HADD3_3_3_1 7
??=define HADD3_3_4_1 8
??=define HADD3_3_5_1 9
??=define HADD3_3_6_1 0
??=define HADD3_3_7_1 1
??=define HADD3_3_8_1 2
??=define HADD3_3_9_1 3

??=define HADD3_4_0_1 5
??=define HADD3_4_1_1 6
??=define HADD3_4_2_1 7
??=define HADD3_4_3_1 8
??=define HADD3_4_4_1 9
??=define HADD3_4_5_1 0
??=define HADD3_4_6_1 1
??=define HADD3_4_7_1 2
??=define HADD3_4_8_1 3
??=define HADD3_4_9_1 4

??=define HADD3_5_0_1 6
??=define HADD3_5_1_1 7
??=define HADD3_5_2_1 8
??=define HADD3_5_3_1 9
??=define HADD3_5_4_1 0
??=define HADD3_5_5_1 1
??=define HADD3_5_6_1 2
??=define HADD3_5_7_1 3
??=define HADD3_5_8_1 4
??=define HADD3_5_9_1 5

??=define HADD3_6_0_1 7
??=define HADD3_6_1_1 8
??=define HADD3_6_2_1 9
??=define HADD3_6_3_1 0
??=define HADD3_6_4_1 1
??=define HADD3_6_5_1 2
??=define HADD3_6_6_1 3
??=define HADD3_6_7_1 4
??=define HADD3_6_8_1 5
??=define HADD3_6_9_1 6

??=define HADD3_7_0_1 8
??=define HADD3_7_1_1 9
??=define HADD3_7_2_1 0
??=define HADD3_7_3_1 1
??=define HADD3_7_4_1 2
??=define HADD3_7_5_1 3
??=define HADD3_7_6_1 4
??=define HADD3_7_7_1 5
??=define HADD3_7_8_1 6
??=define HADD3_7_9_1 7

??=define HADD3_8_0_1 9
??=define HADD3_8_1_1 0
??=define HADD3_8_2_1 1
??=define HADD3_8_3_1 2
??=define HADD3_8_4_1 3
??=define HADD3_8_5_1 4
??=define HADD3_8_6_1 5
??=define HADD3_8_7_1 6
??=define HADD3_8_8_1 7
??=define HADD3_8_9_1 8

??=define HADD3_9_0_1 0
??=define HADD3_9_1_1 1
??=define HADD3_9_2_1 2
??=define HADD3_9_3_1 3
??=define HADD3_9_4_1 4
??=define HADD3_9_5_1 5
??=define HADD3_9_6_1 6
??=define HADD3_9_7_1 7
??=define HADD3_9_8_1 8
??=define HADD3_9_9_1 9

??=define CARRY3_0_0_0 0
??=define CARRY3_0_1_0 0
??=define CARRY3_0_2_0 0
??=define CARRY3_0_3_0 0
??=define CARRY3_0_4_0 0
??=define CARRY3_0_5_0 0
??=define CARRY3_0_6_0 0
??=define CARRY3_0_7_0 0
??=define CARRY3_0_8_0 0
??=define CARRY3_0_9_0 0

??=define CARRY3_1_0_0 0
??=define CARRY3_1_1_0 0
??=define CARRY3_1_2_0 0
??=define CARRY3_1_3_0 0
??=define CARRY3_1_4_0 0
??=define CARRY3_1_5_0 0
??=define CARRY3_1_6_0 0
??=define CARRY3_1_7_0 0
??=define CARRY3_1_8_0 0
??=define CARRY3_1_9_0 1

??=define CARRY3_2_0_0 0
??=define CARRY3_2_1_0 0
??=define CARRY3_2_2_0 0
??=define CARRY3_2_3_0 0
??=define CARRY3_2_4_0 0
??=define CARRY3_2_5_0 0
??=define CARRY3_2_6_0 0
??=define CARRY3_2_7_0 0
??=define CARRY3_2_8_0 1
??=define CARRY3_2_9_0 1

??=define CARRY3_3_0_0 0
??=define CARRY3_3_1_0 0
??=define CARRY3_3_2_0 0
??=define CARRY3_3_3_0 0
??=define CARRY3_3_4_0 0
??=define CARRY3_3_5_0 0
??=define CARRY3_3_6_0 0
??=define CARRY3_3_7_0 1
??=define CARRY3_3_8_0 1
??=define CARRY3_3_9_0 1

??=define CARRY3_4_0_0 0
??=define CARRY3_4_1_0 0
??=define CARRY3_4_2_0 0
??=define CARRY3_4_3_0 0
??=define CARRY3_4_4_0 0
??=define CARRY3_4_5_0 0
??=define CARRY3_4_6_0 1
??=define CARRY3_4_7_0 1
??=define CARRY3_4_8_0 1
??=define CARRY3_4_9_0 1

??=define CARRY3_5_0_0 0
??=define CARRY3_5_1_0 0
??=define CARRY3_5_2_0 0
??=define CARRY3_5_3_0 0
??=define CARRY3_5_4_0 0
??=define CARRY3_5_5_0 1
??=define CARRY3_5_6_0 1
??=define CARRY3_5_7_0 1
??=define CARRY3_5_8_0 1
??=define CARRY3_5_9_0 1

??=define CARRY3_6_0_0 0
??=define CARRY3_6_1_0 0
??=define CARRY3_6_2_0 0
??=define CARRY3_6_3_0 0
??=define CARRY3_6_4_0 1
??=define CARRY3_6_5_0 1
??=define CARRY3_6_6_0 1
??=define CARRY3_6_7_0 1
??=define CARRY3_6_8_0 1
??=define CARRY3_6_9_0 1

??=define CARRY3_7_0_0 0
??=define CARRY3_7_1_0 0
??=define CARRY3_7_2_0 0
??=define CARRY3_7_3_0 1
??=define CARRY3_7_4_0 1
??=define CARRY3_7_5_0 1
??=define CARRY3_7_6_0 1
??=define CARRY3_7_7_0 1
??=define CARRY3_7_8_0 1
??=define CARRY3_7_9_0 1

??=define CARRY3_8_0_0 0
??=define CARRY3_8_1_0 0
??=define CARRY3_8_2_0 1
??=define CARRY3_8_3_0 1
??=define CARRY3_8_4_0 1
??=define CARRY3_8_5_0 1
??=define CARRY3_8_6_0 1
??=define CARRY3_8_7_0 1
??=define CARRY3_8_8_0 1
??=define CARRY3_8_9_0 1

??=define CARRY3_9_0_0 0
??=define CARRY3_9_1_0 1
??=define CARRY3_9_2_0 1
??=define CARRY3_9_3_0 1
??=define CARRY3_9_4_0 1
??=define CARRY3_9_5_0 1
??=define CARRY3_9_6_0 1
??=define CARRY3_9_7_0 1
??=define CARRY3_9_8_0 1
??=define CARRY3_9_9_0 1

??=define CARRY3_0_0_1 0
??=define CARRY3_0_1_1 0
??=define CARRY3_0_2_1 0
??=define CARRY3_0_3_1 0
??=define CARRY3_0_4_1 0
??=define CARRY3_0_5_1 0
??=define CARRY3_0_6_1 0
??=define CARRY3_0_7_1 0
??=define CARRY3_0_8_1 0
??=define CARRY3_0_9_1 1

??=define CARRY3_1_0_1 0
??=define CARRY3_1_1_1 0
??=define CARRY3_1_2_1 0
??=define CARRY3_1_3_1 0
??=define CARRY3_1_4_1 0
??=define CARRY3_1_5_1 0
??=define CARRY3_1_6_1 0
??=define CARRY3_1_7_1 0
??=define CARRY3_1_8_1 1
??=define CARRY3_1_9_1 1

??=define CARRY3_2_0_1 0
??=define CARRY3_2_1_1 0
??=define CARRY3_2_2_1 0
??=define CARRY3_2_3_1 0
??=define CARRY3_2_4_1 0
??=define CARRY3_2_5_1 0
??=define CARRY3_2_6_1 0
??=define CARRY3_2_7_1 1
??=define CARRY3_2_8_1 1
??=define CARRY3_2_9_1 1

??=define CARRY3_3_0_1 0
??=define CARRY3_3_1_1 0
??=define CARRY3_3_2_1 0
??=define CARRY3_3_3_1 0
??=define CARRY3_3_4_1 0
??=define CARRY3_3_5_1 9
??=define CARRY3_3_6_1 1
??=define CARRY3_3_7_1 1
??=define CARRY3_3_8_1 1
??=define CARRY3_3_9_1 1

??=define CARRY3_4_0_1 0
??=define CARRY3_4_1_1 0
??=define CARRY3_4_2_1 0
??=define CARRY3_4_3_1 0
??=define CARRY3_4_4_1 0
??=define CARRY3_4_5_1 1
??=define CARRY3_4_6_1 1
??=define CARRY3_4_7_1 1
??=define CARRY3_4_8_1 1
??=define CARRY3_4_9_1 1

??=define CARRY3_5_0_1 0
??=define CARRY3_5_1_1 0
??=define CARRY3_5_2_1 0
??=define CARRY3_5_3_1 0
??=define CARRY3_5_4_1 1
??=define CARRY3_5_5_1 1
??=define CARRY3_5_6_1 1
??=define CARRY3_5_7_1 1
??=define CARRY3_5_8_1 1
??=define CARRY3_5_9_1 1

??=define CARRY3_6_0_1 0
??=define CARRY3_6_1_1 0
??=define CARRY3_6_2_1 0
??=define CARRY3_6_3_1 1
??=define CARRY3_6_4_1 1
??=define CARRY3_6_5_1 1
??=define CARRY3_6_6_1 1
??=define CARRY3_6_7_1 1
??=define CARRY3_6_8_1 1
??=define CARRY3_6_9_1 1

??=define CARRY3_7_0_1 0
??=define CARRY3_7_1_1 0
??=define CARRY3_7_2_1 1
??=define CARRY3_7_3_1 1
??=define CARRY3_7_4_1 1
??=define CARRY3_7_5_1 1
??=define CARRY3_7_6_1 1
??=define CARRY3_7_7_1 1
??=define CARRY3_7_8_1 1
??=define CARRY3_7_9_1 1

??=define CARRY3_8_0_1 0
??=define CARRY3_8_1_1 1
??=define CARRY3_8_2_1 1
??=define CARRY3_8_3_1 1
??=define CARRY3_8_4_1 1
??=define CARRY3_8_5_1 1
??=define CARRY3_8_6_1 1
??=define CARRY3_8_7_1 1
??=define CARRY3_8_8_1 1
??=define CARRY3_8_9_1 1

??=define CARRY3_9_0_1 1
??=define CARRY3_9_1_1 1
??=define CARRY3_9_2_1 1
??=define CARRY3_9_3_1 1
??=define CARRY3_9_4_1 1
??=define CARRY3_9_5_1 1
??=define CARRY3_9_6_1 1
??=define CARRY3_9_7_1 1
??=define CARRY3_9_8_1 1
??=define CARRY3_9_9_1 1

??=define HALF_ADD(a, b) ADD??=??=a??=??=_??=??=b

??=define CARRY(a, b) CARRY2_??=??=a??=??=_??=??=b

??=define HALF_ADD3(a, b, c) HADD3_??=??=a??=??=_??=??=b??=??=_??=??=c

??=define XHALF_ADD3(a, b, c) HALF_ADD3(a, b, c)

??=define	CARRY3(a, b, c) CARRY3_??=??=a??=??=_??=??=b??=??=_??=??=c

??=define XCARRY3(a, b, c) CARRY3(a, b, c)

??=define TENS_ADD(a, b, c, d) XJOIN(HADD3_??=??=a??=??=_??=??=b??=??=_??=??=c, d)

??=define XTENS_ADD(a, b, c, d) TENS_ADD(a, b, c, d)

??=define ADD_LONG(a1, a2, b1, b2) a1??=??=a2 + b1??=??=b2 = XJOIN(XCARRY3(a1, b1, CARRY(a2, b2)), XTENS_ADD(a1, b1, CARRY(a2, b2), HALF_ADD(a2, b2)))

??=define ADD_SHORT(a, b) a + b = XJOIN(CARRY(a, b), HALF_ADD(a, b))

??=define ADD_5DIGIT(a1, b1, a2, b2, a3, b3, a4, b4, a5, b5) a1??=??=a2??=??=a3??=??=a4??=??=a5 + b1??=??=b2??=??=b3??=??=b4??=??=b5 = XJOIN(XCARRY3(a1, b1, XCARRY3(a2, b2, XCARRY3(a3, b3, XCARRY3(a4, b4, CARRY(a5, b5))))), XJOIN(XHALF_ADD3(a1, b1, XCARRY3(a2, b2, XCARRY3(a3, b3, XCARRY3(a4, b4, CARRY(a5, b5))))), XJOIN(XHALF_ADD3(a2, b2, XCARRY3(a3, b3, XCARRY3(a4, b4, CARRY(a5, b5)))), XJOIN(XHALF_ADD3(a3, b3, XCARRY3(a4, b4, CARRY(a5, b5))), XJOIN(XHALF_ADD3(a4, b4, CARRY(a5, b5)), HALF_ADD(a5, b5))))))
